define("user:widget/public-header/public-header-async.js",function(e,n,t){var o=e("common:widget/ui/jquery/jquery.js"),i=e("user:widget/ui/subpage-delete/subpage-delete.js"),r=e("common:widget/ui/ownerGuide/ownerGuide.js"),a=e("person"),u=function(){var n=o(".public-header"),t=n.offset();o(document).on("scroll",function(){var e=o(window).scrollTop();e>t.top+n.height()/2?o("#body").addClass("header-slide-down"):o("#body").removeClass("header-slide-down")});var u="/user/ajax/getcommentnum?format=ajax&t="+(new Date).getTime();if(o.get(u,{uid:a.uid},function(n){var t=n.errno;if(0==t){var i=n.data&&n.data.comment_count||0;e("person").comment_count=i,o("#J_nav-comment").text(i),o("#J_comment-page-count").text(i)}},"json"),o(document).delegate("#J_owner-guide","click",function(){var e=31;o.get("/user/ajax/message/getmsgtypeconfig","",function(n){if(0==n.errno){var t=n.data,i=t.content_config,u=i[e];o(u).each(function(e,n){n.content=c(n.content,{uname:a.uname})}),r.init({content:u,msgType:e,uid:a.uid})}},"json")}),parseInt(o.browser.version,10)<9){var s=o("#J_navigation-more");s.on("mouseenter",function(){d&&(clearTimeout(d),d=null),o(this).find("ul").show()});var d;s.on("mouseleave",function(){$this=o(this),d=setTimeout(function(){$this.find("ul").hide()},300)})}i.init()},c=function(e,n){e=String(e);var t=Array.prototype.slice.call(arguments,1),o=Object.prototype.toString;return t.length?(t=1==t.length&&null!==n&&/\[object Array\]|\[object Object\]/.test(o.call(n))?n:t,e.replace(/#\{(.+?)\}/g,function(e,n){var i=t[n];return"[object Function]"==o.call(i)&&(i=i(n)),"undefined"==typeof i?"":i})):e};t.exports=u});
;define("user:widget/public-pagetab/public-pagetab-async.js",function(e,a,t){var n=e("common:widget/ui/jquery/jquery.js"),c=function(){n(".page-tab").on("click",function(){n(".page-tab").removeClass("current"),n(this).addClass("current")})};t.exports=c});
;define("user:widget/public-panel/public-panel.js",function(a,e,o){var n=a("common:widget/ui/jquery/jquery.js"),t=a("common:widget/ui/lite/lite.js");a("common:widget/ui/jq-dialog/jq-dialog.js");var r=a("usercenter"),i=a("person"),c=a("user"),s={init:function(){this.panel=n(".public-panel"),this.backgroundUrl=i.background_url||"/static/user/widget/layout-core/img/layout-bg.png",this.eventBind()},follow:function(a){var e=a.attr("data-action"),o=a.attr("data-uid"),t="/user/follow/"+("follow"==e?"save":"cancel")+"?format=ajax";n.post(t,{uid:o,bdstoken:c.bdstoken||0},function(o){var n=o.errno;0==n&&a.attr("data-action","follow"==e?"cancel":"follow").toggleClass("followed").find(".J_follow-text").text("follow"==e?"取消关注":"关注")},"json")},usercenterBackgound:function(a){var e=this;this.bgImage=n("#body"),this.oldBackgroundUrl=this.bgImage.css("backgroundImage"),this.saveBackground=!1;a.parents(".header-wrapper");if(r.backgrounds&&r.backgrounds.length>0){var o=[];n(r.backgrounds).each(function(a,e){e.pic_url&&o.push('<div class="background-wrap J_background-wrap">','<a href="###" class="background-item" target-img="http://hiphotos.baidu.com/lvpics/pic/item/'+e.pic_url+'.jpg">',t.createImage("",e.pic_url,e.width||180,e.height||120,180,120,!1,!1),'<span class="background-selected J_background-select"></span>',"</a>","<p>",e.from,"</p>","</div>")});var i=n(['<div class="background-change-wraper">','<div class="background-list">',o.join(""),"</div>",'<a class="background-save" href="###" id="J_background-save">确定</a>',"</div>"].join(""));if(this.backgroundsDialog)this.backgroundsDialog.dialog("open");else{{var c=n(window).height();n(window).width()}this.backgroundsDialog=i.dialog({title:"更换背景",width:980,modal:!0,resizable:!1,position:["center",c/2-150],dialogClass:"usercenter-background-dialog ui-dialog-notitle",close:function(){e.saveBackground||(e.bgImage.css({backgroundImage:e.oldBackgroundUrl}),e.oldBackgroundUrl="")}})}}},changeUserCenterBackground:function(a){var e=this;a.hasClass("selected")?this.backgroundCanPost=!1:(a.parent().find(".selected").removeClass("selected"),this.backgroundCanPost=!0),a.toggleClass("selected"),this.backgroundUrl=a.parent().find(".selected .background-item").attr("target-img"),e.bgImage.css(this.backgroundUrl?{backgroundImage:"url("+e.backgroundUrl+")"}:{backgroundImage:e.oldBackgroundUrl})},saveUserCenterBackground:function(){var a=this,e="/user/ajax/setbgpic?format=ajax",o=a.getPicId(a.backgroundUrl);n.post(e,{pic:o,bdstoken:c.bdstoken||0},function(e){var o=e.errno;0==o&&(a.saveBackground=!0,a.backgroundsDialog.dialog("close"),a.bgImage.css({backgroundImage:"url("+a.backgroundUrl+")"}),a.oldBackgroundUrl="")},"json")},eventBind:function(){var a=this;if(n(document).delegate(".J_user-follow","click",function(){var e=n(this);a.follow(e)}),n(document).delegate("#J_panel-background","click",function(){var e=n(this);a.usercenterBackgound(e)}),n(document).delegate(".J_background-wrap","click",function(){var e=n(this);a.changeUserCenterBackground(e)}),n(document).delegate("#J_background-save","click",function(){a.backgroundCanPost?a.saveUserCenterBackground():a.backgroundsDialog.dialog("close")}),parseInt(n.browser.version,10)<9){var e=n("#J_panel-setting");e.on("mouseenter",function(){o&&(clearTimeout(o),o=null),n(this).find("ul").show()});var o;e.on("mouseleave",function(){$this=n(this),o=setTimeout(function(){$this.find("ul").hide()},300)})}},getPicId:function(a){var e=new RegExp("http://hiphotos.baidu.com/lvpics/pic/item/([a-z0-9]+).jpg","g");return a.match(e),RegExp.$1}};o.exports=s});
;define("user:widget/public-sidebar/public-sidebar-async.js",function(e,i,t){var s=e("common:widget/ui/jquery-ext/jquery-ext.js"),a=e("common:widget/ui/usercard/usercard.js"),r=e("common:widget/ui/lite/lite.js"),n=e("person"),d=e("user"),o={init:function(){this.sidebar=s("#J_public-sidebar"),this.sidebar.length&&(window.screen.width<=1024&&this.sidebar.hide(),n.is_myself||this.updateViewCount(),this.getVisitorList(),this.eventBind())},updateViewCount:function(){var e="/user/ajax/updateviewcount?format=ajax";s.post(e,{uid:n.uid,bdstoken:d.bdstoken||0},function(){},"json")},getVisitorList:function(){var e="/user/ajax/getlatestvisitors?format=ajax",i=s("#J_visitor-list"),t=8,d=[];s.get(e,{uid:n.uid,t:(new Date).getTime()},function(e){var n=e.errno;if(0===n){var o=e.data,u=o&&o.vistor_list;u&&u.length>0&&(s(u).each(function(e,i){if(e!=t){var a=['<li class="usercard" data-usercard='+i.uid+">",'<a title="',s.string.encodeHTML(i.uname),'" target="_blank" href="/user/',i.uid,'">','<img src="',r.getUserHead(i.avatar_middle,i.avatar_source),'"/>',"</a>","</li>"].join("");d.push(a)}}),i.append(s(d.join(""))),a.create(s(".usercard")))}},"json")},visitorRecommend:function(e){var i=e.hasClass("is-recommended");i||s.post("/user/ajax/updatepraisecount?format=ajax",{uid:n.uid,bdstoken:d.bdstoken||0},function(i){var t=i.errno;0==t&&e.addClass("is-recommended")},"json")},eventBind:function(){var e=this;this.sidebar.delegate(".visitor-recommend","click",function(){var i=s(this);e.visitorRecommend(i)})}};t.exports=o});